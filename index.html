<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ç¡¬è´¨åˆé‡‘æŸ¥è¯¢</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Microsoft YaHei", sans-serif;
      margin: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 6px;
      font-size: 16px; /* å¢åŠ åŸºç¡€å­—ä½“å¤§å° */
      line-height: 1.4; /* å¢åŠ è¡Œé«˜æé«˜å¯è¯»æ€§ */
    }

    .container {
      max-width: 100%;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.98);
      padding: 12px 10px;
      border-radius: 10px;
      box-shadow: 0 3px 15px rgba(0, 0, 0, 0.1);
    }

    .header {
      text-align: center;
      margin-bottom: 16px;
      padding: 0 6px;
    }

    h1 {
      color: #2c3e50;
      font-size: 1.4em; /* å¢åŠ æ ‡é¢˜å­—ä½“å¤§å° */
      margin-bottom: 6px;
      font-weight: 700;
      background: linear-gradient(135deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      line-height: 1.2;
    }

    .subtitle {
      color: #7f8c8d;
      font-size: 0.9em; /* å¢åŠ å‰¯æ ‡é¢˜å­—ä½“å¤§å° */
      margin-bottom: 12px;
      line-height: 1.3;
    }

    .search-section {
      background: white;
      padding: 14px 10px;
      border-radius: 8px;
      box-shadow: 0 1px 6px rgba(0, 0, 0, 0.06);
      margin-bottom: 14px;
    }

    .search-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px; /* å¢åŠ é—´è· */
      margin-bottom: 14px;
    }

    .search-group {
      display: flex;
      flex-direction: column;
    }

    label {
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 5px; /* å¢åŠ æ ‡ç­¾ä¸‹è¾¹è· */
      font-size: 0.95em; /* å¢åŠ æ ‡ç­¾å­—ä½“å¤§å° */
      display: flex;
      align-items: center;
      gap: 5px;
    }

    input {
      padding: 12px 10px; /* å¢åŠ è¾“å…¥æ¡†å†…è¾¹è· */
      border: 1px solid #e9ecef;
      border-radius: 5px;
      font-size: 16px; /* å¢åŠ è¾“å…¥æ¡†å­—ä½“å¤§å° */
      transition: all 0.2s ease;
      background: #f8f9fa;
      width: 100%;
      -webkit-appearance: none;
      min-height: 48px; /* å¢åŠ è¾“å…¥æ¡†é«˜åº¦ */
    }

    input:focus {
      outline: none;
      border-color: #667eea;
      background: white;
      box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
    }

    .button-group {
      display: flex;
      gap: 8px; /* å¢åŠ æŒ‰é’®é—´è· */
      justify-content: center;
      margin-top: 8px;
      flex-direction: column;
    }

    button {
      padding: 14px 16px; /* å¢åŠ æŒ‰é’®å†…è¾¹è· */
      border: none;
      border-radius: 5px;
      font-size: 16px; /* å¢åŠ æŒ‰é’®å­—ä½“å¤§å° */
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      width: 100%;
      min-height: 48px; /* å¢åŠ æŒ‰é’®é«˜åº¦ */
    }

    .search-btn {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      box-shadow: 0 1px 6px rgba(102, 126, 234, 0.3);
    }

    .search-btn:active {
      transform: scale(0.98);
      box-shadow: 0 1px 3px rgba(102, 126, 234, 0.4);
    }

    .clear-btn {
      background: #95a5a6;
      color: white;
    }

    .clear-btn:active {
      background: #7f8c8d;
      transform: scale(0.98);
    }

    .results-section {
      background: white;
      padding: 14px 10px;
      border-radius: 8px;
      box-shadow: 0 1px 6px rgba(0, 0, 0, 0.06);
    }

    .results-header {
      font-size: 1.2em; /* å¢åŠ ç»“æœæ ‡é¢˜å­—ä½“å¤§å° */
      color: #2c3e50;
      margin-bottom: 12px;
      text-align: center;
      font-weight: 600;
      padding: 0 3px;
    }

    .result-item {
      background: linear-gradient(135deg, #f8f9fa, #e9ecef);
      padding: 16px 12px; /* å¢åŠ ç»“æœé¡¹å†…è¾¹è· */
      border-radius: 8px;
      border-left: 2px solid #667eea;
      margin-bottom: 12px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
    }

    .result-header {
      display: flex;
      flex-direction: column;
      gap: 8px; /* å¢åŠ æ ‡é¢˜åŒºåŸŸé—´è· */
      margin-bottom: 10px;
    }

    .result-title {
      font-size: 1.1em; /* å¢åŠ ç»“æœæ ‡é¢˜å­—ä½“å¤§å° */
      font-weight: 700;
      color: #2c3e50;
      line-height: 1.2;
    }

    .match-badge {
      padding: 5px 8px; /* å¢åŠ å¾½ç« å†…è¾¹è· */
      border-radius: 10px;
      font-size: 0.85em; /* å¢åŠ å¾½ç« å­—ä½“å¤§å° */
      font-weight: 600;
      text-align: center;
      width: fit-content;
    }

    .perfect-match {
      background: linear-gradient(135deg, #00b09b, #96c93d);
      color: white;
    }

    .recommend {
      background: linear-gradient(135deg, #ff9a9e, #fecfef);
      color: white;
    }

    .certified {
      background: linear-gradient(135deg, #a8c0ff, #3f4c6b);
      color: white;
    }

    .exceed-warning {
      background: linear-gradient(135deg, #ff6b6b, #ffa726);
      color: white;
    }

    .property-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      background: white;
      border-radius: 5px;
      overflow: hidden;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.04);
      font-size: 0.9em; /* å¢åŠ è¡¨æ ¼å­—ä½“å¤§å° */
    }

    .property-table th {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 8px 6px; /* å¢åŠ è¡¨å¤´å†…è¾¹è· */
      text-align: left;
      font-weight: 600;
      font-size: 0.9em; /* å¢åŠ è¡¨å¤´å­—ä½“å¤§å° */
      white-space: nowrap;
    }

    .property-table td {
      padding: 6px; /* å¢åŠ è¡¨æ ¼å•å…ƒæ ¼å†…è¾¹è· */
      border-bottom: 1px solid #e9ecef;
      word-break: break-word;
      vertical-align: top;
      line-height: 1.3;
    }

    .property-table tr:last-child td {
      border-bottom: none;
    }

    .property-name {
      font-weight: 600;
      color: #2c3e50;
      width: 60px; /* å¢åŠ å±æ€§åç§°åˆ—å®½åº¦ */
      white-space: nowrap;
      font-size: 0.9em; /* å¢åŠ å±æ€§åç§°å­—ä½“å¤§å° */
    }

    .match-status {
      text-align: center;
      padding: 5px 3px; /* å¢åŠ çŠ¶æ€å•å…ƒæ ¼å†…è¾¹è· */
      border-radius: 3px;
      font-weight: 600;
      font-size: 0.85em; /* å¢åŠ çŠ¶æ€å­—ä½“å¤§å° */
      min-width: 50px; /* å¢åŠ çŠ¶æ€åˆ—æœ€å°å®½åº¦ */
    }

    .status-match {
      background: #d4edda;
      color: #155724;
    }

    .status-mismatch {
      background: #f8d7da;
      color: #721c24;
    }

    .status-exceed {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }

    .no-match {
      text-align: center;
      padding: 24px 16px; /* å¢åŠ æ— ç»“æœåŒºåŸŸå†…è¾¹è· */
      color: #7f8c8d;
      font-size: 1em; /* å¢åŠ æ— ç»“æœå­—ä½“å¤§å° */
    }

    .no-match div:first-child {
      font-size: 2em; /* å¢åŠ å›¾æ ‡å¤§å° */
      margin-bottom: 8px;
      opacity: 0.7;
    }

    .match-summary {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 10px; /* å¢åŠ æ‘˜è¦å†…è¾¹è· */
      border-radius: 5px;
      margin-bottom: 10px;
      text-align: center;
      font-weight: 600;
      font-size: 0.9em; /* å¢åŠ æ‘˜è¦å­—ä½“å¤§å° */
      line-height: 1.2;
    }

    .exceed-summary {
      background: linear-gradient(135deg, #ff6b6b, #ffa726);
      color: white;
      padding: 10px; /* å¢åŠ è­¦å‘Šæ‘˜è¦å†…è¾¹è· */
      border-radius: 5px;
      margin-bottom: 10px;
      text-align: center;
      font-weight: 600;
      font-size: 0.9em; /* å¢åŠ è­¦å‘Šæ‘˜è¦å­—ä½“å¤§å° */
      line-height: 1.2;
    }

    .data-source {
      font-size: 0.8em; /* å¢åŠ æ•°æ®æ¥æºå­—ä½“å¤§å° */
      color: #6c757d;
      font-style: italic;
    }

    .exceed-warning-text {
      color: #dc3545;
      font-weight: 600;
      font-size: 0.8em; /* å¢åŠ è­¦å‘Šæ–‡æœ¬å­—ä½“å¤§å° */
      margin-top: 2px;
      line-height: 1.2;
    }

    /* è¶…å°å±æ‰‹æœºä¼˜åŒ– */
    @media (max-width: 320px) {
      body {
        padding: 4px;
        font-size: 14px; /* å¢åŠ è¶…å°å±åŸºç¡€å­—ä½“å¤§å° */
      }
      
      .container {
        padding: 10px 8px;
      }
      
      h1 {
        font-size: 1.3em;
      }
      
      .search-section,
      .results-section {
        padding: 12px 8px;
      }
      
      input {
        padding: 10px 8px;
        font-size: 15px;
        min-height: 44px;
      }
      
      button {
        padding: 12px 14px;
        min-height: 44px;
        font-size: 15px;
      }
      
      .property-table {
        font-size: 0.85em;
      }
      
      .property-table th,
      .property-table td {
        padding: 5px;
      }
    }

    /* å°å±æ‰‹æœºä¼˜åŒ– */
    @media (min-width: 321px) and (max-width: 375px) {
      body {
        padding: 5px;
        font-size: 15px;
      }
      
      .container {
        padding: 11px 9px;
      }
    }

    /* å¹³æ¿è®¾å¤‡é€‚é… */
    @media (min-width: 480px) {
      body {
        padding: 10px;
        font-size: 16px;
      }
      
      .container {
        padding: 18px 14px;
      }
      
      h1 {
        font-size: 1.6em;
      }
      
      .button-group {
        flex-direction: row;
      }
      
      button {
        width: auto;
        min-width: 120px;
      }
      
      .search-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 14px;
      }
      
      .property-table {
        font-size: 0.95em;
      }
    }

    /* æ¡Œé¢è®¾å¤‡é€‚é… */
    @media (min-width: 768px) {
      body {
        padding: 12px;
      }
      
      .container {
        max-width: 900px;
        padding: 20px 16px;
      }
      
      h1 {
        font-size: 1.8em;
      }
      
      .search-grid {
        grid-template-columns: repeat(3, 1fr);
      }
      
      .property-table {
        font-size: 1em;
      }
    }

    /* å¤§å±è®¾å¤‡é€‚é… */
    @media (min-width: 1024px) {
      .search-grid {
        grid-template-columns: repeat(5, 1fr);
      }
    }

    /* é˜²æ­¢iOSç¼©æ”¾ */
    input, select, textarea {
      font-size: 16px;
    }

    /* è§¦æ‘¸è®¾å¤‡ä¼˜åŒ– */
    @media (hover: none) and (pointer: coarse) {
      button:active {
        transform: scale(0.96);
      }
      
      .result-item:active {
        opacity: 0.9;
      }
    }

    /* æ»šåŠ¨æ¡ä¼˜åŒ– */
    .results {
      max-height: 50vh;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    .results::-webkit-scrollbar {
      width: 4px; /* å¢åŠ æ»šåŠ¨æ¡å®½åº¦ */
    }

    .results::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 2px;
    }

    .results::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 2px;
    }

    .results::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }

    /* è¡¨æ ¼å“åº”å¼ä¼˜åŒ– */
    @media (max-width: 480px) {
      .property-table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
      }
      
      .property-table th,
      .property-table td {
        min-width: 70px; /* å¢åŠ è¡¨æ ¼æœ€å°å®½åº¦ */
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ” ç¡¬è´¨åˆé‡‘æŸ¥è¯¢</h1>
      <div class="subtitle">è¾“å…¥äº§å“å±æ€§å‚æ•°ï¼Œå¿«é€ŸåŒ¹é…æœ€é€‚åˆçš„ç¡¬è´¨åˆé‡‘ç‰Œå·</div>
    </div>

    <div class="search-section">
      <div class="search-grid">
        <div class="search-group">
          <label>ğŸ“Š å¯†åº¦</label>
          <input type="number" id="density" step="0.01" placeholder="è¾“å…¥å¯†åº¦">
        </div>
        <div class="search-group">
          <label>ğŸ’ ç¡¬åº¦</label>
          <input type="number" id="hardness" step="0.1" placeholder="è¾“å…¥ç¡¬åº¦">
        </div>
        <div class="search-group">
          <label>ğŸ§² çŸ«é¡½ç£åŠ›</label>
          <input type="number" id="coercivity" step="0.1" placeholder="è¾“å…¥çŸ«é¡½ç£åŠ›">
        </div>
        <div class="search-group">
          <label>âš¡ é’´ç£</label>
          <input type="number" id="cobalt" step="0.01" placeholder="è¾“å…¥é’´ç£">
        </div>
        <div class="search-group">
          <label>ğŸ›¡ï¸ å¼ºåº¦</label>
          <input type="number" id="strength" step="1" placeholder="è¾“å…¥å¼ºåº¦">
        </div>
      </div>
      
      <div class="button-group">
        <button class="search-btn" onclick="search()">
          <span>ğŸ” æŸ¥è¯¢åŒ¹é…</span>
        </button>
        <button class="clear-btn" onclick="clearSearch()">
          <span>ğŸ—‘ï¸ æ¸…ç©ºè¾“å…¥</span>
        </button>
      </div>
    </div>

    <div class="results-section">
      <div class="results-header">ğŸ“‹ åŒ¹é…ç»“æœ</div>
      <div class="results" id="results">
        <div class="no-match">
          <div>ğŸ”</div>
          <div>è¯·è¾“å…¥æŸ¥è¯¢æ¡ä»¶ï¼Œç³»ç»Ÿå°†ä¸ºæ‚¨æ¨èæœ€åŒ¹é…çš„ç¡¬è´¨åˆé‡‘ç‰Œå·</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // å®Œæ•´çš„Excelæ•°æ®ï¼ˆè¿™é‡Œä¿æŒä¸ä¹‹å‰ç›¸åŒçš„æ•°æ®ï¼‰
    const data = [
       // è€ç£¨åˆé‡‘äº‹ä¸šéƒ¨
      { dept: "è€ç£¨åˆé‡‘äº‹ä¸šéƒ¨", brand: "YG6A", density: 14.65, hardness: 92.6, coercivity: 24.4, cobalt: 5.25, strength: 2000, prod_density: null, prod_hardness: null, prod_coercivity: null, prod_cobalt: null, prod_strength: null },
      { dept: "è€ç£¨åˆé‡‘äº‹ä¸šéƒ¨", brand: "YG6X", density: 14.85, hardness: 91.9, coercivity: 19.5, cobalt: 5.35, strength: 2200, prod_density: 14.85, prod_hardness: 91.7, prod_coercivity: 18.8, prod_cobalt: 5.3, prod_strength: 2200 },
      { dept: "è€ç£¨åˆé‡‘äº‹ä¸šéƒ¨", brand: "YG8K", density: 14.62, hardness: 89, coercivity: 8.8, cobalt: 7.17, strength: 2500, prod_density: 14.62, prod_hardness: 88.5, prod_coercivity: 8.6, prod_cobalt: 7.1, prod_strength: 2500 },
      // ... å…¶ä½™æ•°æ®ä¿æŒä¸å˜
    ];

    // è®¡ç®—ä¸¤ä¸ªæ•°å€¼ä¹‹é—´çš„ç»å¯¹å·®
    function diff(a, b) {
      if (a === null || b === null) return Infinity;
      return Math.abs(a - b);
    }

    // æ£€æŸ¥æ˜¯å¦è¶…å‡ºå‚è€ƒæ•°æ®2å€
    function checkExceedReference(input, referenceValue) {
      if (input === null || referenceValue === null) return false;
      return input > referenceValue * 2;
    }

    // è·å–æ‰€æœ‰æ•°æ®çš„å‚è€ƒèŒƒå›´
    function getReferenceRanges() {
      const ranges = {
        density: { min: Infinity, max: -Infinity },
        hardness: { min: Infinity, max: -Infinity },
        coercivity: { min: Infinity, max: -Infinity },
        cobalt: { min: Infinity, max: -Infinity },
        strength: { min: Infinity, max: -Infinity }
      };

      data.forEach(item => {
        const values = [
          item.prod_density !== null ? item.prod_density : item.density,
          item.prod_hardness !== null ? item.prod_hardness : item.hardness,
          item.prod_coercivity !== null ? item.prod_coercivity : item.coercivity,
          item.prod_cobalt !== null ? item.prod_cobalt : item.cobalt,
          item.prod_strength !== null ? item.prod_strength : item.strength
        ];

        const properties = ['density', 'hardness', 'coercivity', 'cobalt', 'strength'];
        
        properties.forEach((prop, index) => {
          if (values[index] !== null) {
            ranges[prop].min = Math.min(ranges[prop].min, values[index]);
            ranges[prop].max = Math.max(ranges[prop].max, values[index]);
          }
        });
      });

      return ranges;
    }

    // æ¸…ç©ºæœç´¢æ¡†
    function clearSearch() {
      document.getElementById('density').value = '';
      document.getElementById('hardness').value = '';
      document.getElementById('coercivity').value = '';
      document.getElementById('cobalt').value = '';
      document.getElementById('strength').value = '';
      document.getElementById('results').innerHTML = `
        <div class="no-match">
          <div>ğŸ”</div>
          <div>è¯·è¾“å…¥æŸ¥è¯¢æ¡ä»¶ï¼Œç³»ç»Ÿå°†ä¸ºæ‚¨æ¨èæœ€åŒ¹é…çš„ç¡¬è´¨åˆé‡‘ç‰Œå·</div>
        </div>
      `;
    }

    // æœç´¢å‡½æ•°
    function search() {
      const density = parseFloat(document.getElementById('density').value) || null;
      const hardness = parseFloat(document.getElementById('hardness').value) || null;
      const coercivity = parseFloat(document.getElementById('coercivity').value) || null;
      const cobalt = parseFloat(document.getElementById('cobalt').value) || null;
      const strength = parseFloat(document.getElementById('strength').value) || null;

      const inputs = [density, hardness, coercivity, cobalt, strength];
      const inputCount = inputs.filter(v => v !== null).length;

      // å¦‚æœæ²¡æœ‰è¾“å…¥ä»»ä½•å€¼ï¼Œæ˜¾ç¤ºæç¤º
      if (inputCount === 0) {
        document.getElementById('results').innerHTML = `
          <div class="no-match">
            <div>âš ï¸</div>
            <div>è¯·è¾“å…¥è‡³å°‘ä¸€ä¸ªæœç´¢æ¡ä»¶</div>
          </div>
        `;
        return;
      }

      let candidates = [];
      const referenceRanges = getReferenceRanges();

      // è®¡ç®—æ¯ä¸ªé¡¹ç›®çš„åŒ¹é…åº¦
      data.forEach(item => {
        const prod_density = item.prod_density !== null ? item.prod_density : item.density;
        const prod_hardness = item.prod_hardness !== null ? item.prod_hardness : item.hardness;
        const prod_coercivity = item.prod_coercivity !== null ? item.prod_coercivity : item.coercivity;
        const prod_cobalt = item.prod_cobalt !== null ? item.prod_cobalt : item.cobalt;
        const prod_strength = item.prod_strength !== null ? item.prod_strength : item.strength;

        const values = [prod_density, prod_hardness, prod_coercivity, prod_cobalt, prod_strength];
        
        // è®¡ç®—æ¯ä¸ªå±æ€§çš„å·®å¼‚
        const diffs = inputs.map((input, index) => 
          input !== null && values[index] !== null ? diff(input, values[index]) : Infinity
        );

        // æ£€æŸ¥æ˜¯å¦æœ‰å±æ€§è¶…å‡ºå‚è€ƒèŒƒå›´2å€
        const exceedFlags = inputs.map((input, index) => {
          const propNames = ['density', 'hardness', 'coercivity', 'cobalt', 'strength'];
          return checkExceedReference(input, referenceRanges[propNames[index]].max);
        });

        const hasExceeded = exceedFlags.some(flag => flag);
        const exceedCount = exceedFlags.filter(flag => flag).length;

        // è®¡ç®—æ€»å·®å¼‚
        const totalDiff = diffs.reduce((sum, diff) => 
          sum + (diff !== Infinity ? diff : 1000), 0
        );

        // è®¡ç®—åŒ¹é…æ•°é‡
        const matchCount = diffs.filter(diff => diff === 0).length;

        // æ£€æŸ¥æ˜¯å¦å®Œå…¨åŒ¹é…
        const isPerfectMatch = inputs.every((input, index) => 
          input === null || (values[index] !== null && input === values[index])
        );

        candidates.push({
          ...item,
          matchCount,
          totalDiff,
          isPerfectMatch,
          hasExceeded,
          exceedCount,
          exceedFlags,
          isUsingCertified: item.prod_density === null || item.prod_hardness === null || 
                           item.prod_coercivity === null || item.prod_cobalt === null || 
                           item.prod_strength === null
        });
      });

      // æ’åºå€™é€‰é¡¹ç›®
      candidates.sort((a, b) => {
        if (a.isPerfectMatch && !b.isPerfectMatch) return -1;
        if (!a.isPerfectMatch && b.isPerfectMatch) return 1;
        
        if (b.matchCount !== a.matchCount) {
          return b.matchCount - a.matchCount;
        }
        return a.totalDiff - b.totalDiff;
      });

      // é€‰æ‹©æœ€ä½³åŒ¹é…
      const bestMatch = candidates[0];

      displayResult(bestMatch, inputs, referenceRanges);
    }

    // æ˜¾ç¤ºå•ä¸ªç»“æœ
    function displayResult(item, inputs, referenceRanges) {
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = '';

      if (!item) {
        resultsDiv.innerHTML = `
          <div class="no-match">
            <div>âŒ</div>
            <div>æœªæ‰¾åˆ°åŒ¹é…çš„ç‰Œå·</div>
          </div>
        `;
        return;
      }

      const prod_density = item.prod_density !== null ? item.prod_density : item.density;
      const prod_hardness = item.prod_hardness !== null ? item.prod_hardness : item.hardness;
      const prod_coercivity = item.prod_coercivity !== null ? item.prod_coercivity : item.coercivity;
      const prod_cobalt = item.prod_cobalt !== null ? item.prod_cobalt : item.cobalt;
      const prod_strength = item.prod_strength !== null ? item.prod_strength : item.strength;

      const resultDiv = document.createElement('div');
      resultDiv.className = 'result-item';
      
      // åˆ›å»ºæ ‡é¢˜å’Œå¾½ç« 
      const headerDiv = document.createElement('div');
      headerDiv.className = 'result-header';
      
      const titleDiv = document.createElement('div');
      titleDiv.className = 'result-title';
      titleDiv.textContent = `${item.dept} - ç‰Œå· ${item.brand}`;
      
      const badgeDiv = document.createElement('div');
      badgeDiv.className = 'match-badge ';
      
      if (item.hasExceeded) {
        badgeDiv.classList.add('exceed-warning');
        badgeDiv.textContent = 'âš ï¸ è¶…å‡ºå‚è€ƒèŒƒå›´';
      } else if (item.isPerfectMatch) {
        badgeDiv.classList.add('perfect-match');
        badgeDiv.textContent = 'ğŸ‰ å®Œå…¨åŒ¹é…';
      } else if (item.isUsingCertified) {
        badgeDiv.classList.add('certified');
        badgeDiv.textContent = 'ğŸ“‹ æ®é‰´å®šæ•°æ®æ¨è';
      } else {
        badgeDiv.classList.add('recommend');
        badgeDiv.textContent = 'â­ æ¨èåŒ¹é…';
      }
      
      headerDiv.appendChild(titleDiv);
      headerDiv.appendChild(badgeDiv);
      
      // åˆ›å»ºåŒ¹é…æ‘˜è¦
      let summaryDiv;
      if (item.hasExceeded) {
        summaryDiv = document.createElement('div');
        summaryDiv.className = 'exceed-summary';
        summaryDiv.textContent = `âš ï¸ ${item.exceedCount}ä¸ªå±æ€§å·²è¶…å‡ºå‚è€ƒæ•°æ®2å€èŒƒå›´`;
      } else {
        summaryDiv = document.createElement('div');
        summaryDiv.className = 'match-summary';
        if (item.isPerfectMatch) {
          summaryDiv.textContent = 'ğŸ‰ æ­å–œï¼æ‰€æœ‰è¾“å…¥å±æ€§éƒ½ä¸è¯¥ç‰Œå·å®Œå…¨åŒ¹é…';
        } else {
          summaryDiv.textContent = `âœ… ${item.matchCount}ä¸ªå±æ€§å®Œå…¨åŒ¹é…ï¼Œ${inputs.filter(v => v !== null).length - item.matchCount}ä¸ªå±æ€§ç›¸è¿‘`;
        }
      }
      
      // åˆ›å»ºå±æ€§è¡¨æ ¼
      const tableHTML = `
        <table class="property-table">
          <tr>
            <th>å±æ€§</th>
            <th>è¾“å…¥å€¼</th>
            <th>åŒ¹é…å€¼</th>
            <th>æ•°æ®æ¥æº</th>
            <th>åŒ¹é…çŠ¶æ€</th>
          </tr>
          <tr>
            <td class="property-name">ğŸ“Š å¯†åº¦</td>
            <td>
              ${inputs[0] !== null ? inputs[0] : '-'}
              ${item.exceedFlags[0] ? '<div class="exceed-warning-text">âš ï¸ è¶…å‡º2å€å‚è€ƒ</div>' : ''}
            </td>
            <td>${prod_density !== null ? prod_density : '-'}</td>
            <td><span class="data-source">${item.prod_density !== null ? 'äº§å“æ•°æ®' : 'é‰´å®šæ•°æ®'}</span></td>
            <td class="match-status ${item.exceedFlags[0] ? 'status-exceed' : (inputs[0] !== null && prod_density !== null && inputs[0] === prod_density ? 'status-match' : 'status-mismatch')}">
              ${item.exceedFlags[0] ? 'âš ï¸ è¶…å‡º' : (inputs[0] !== null && prod_density !== null && inputs[0] === prod_density ? 'âœ… åŒ¹é…' : 'âŒ ä¸åŒ¹é…')}
            </td>
          </tr>
          <tr>
            <td class="property-name">ğŸ’ ç¡¬åº¦</td>
            <td>
              ${inputs[1] !== null ? inputs[1] : '-'}
              ${item.exceedFlags[1] ? '<div class="exceed-warning-text">âš ï¸ è¶…å‡º2å€å‚è€ƒ</div>' : ''}
            </td>
            <td>${prod_hardness !== null ? prod_hardness : '-'}</td>
            <td><span class="data-source">${item.prod_hardness !== null ? 'äº§å“æ•°æ®' : 'é‰´å®šæ•°æ®'}</span></td>
            <td class="match-status ${item.exceedFlags[1] ? 'status-exceed' : (inputs[1] !== null && prod_hardness !== null && inputs[1] === prod_hardness ? 'status-match' : 'status-mismatch')}">
              ${item.exceedFlags[1] ? 'âš ï¸ è¶…å‡º' : (inputs[1] !== null && prod_hardness !== null && inputs[1] === prod_hardness ? 'âœ… åŒ¹é…' : 'âŒ ä¸åŒ¹é…')}
            </td>
          </tr>
          <tr>
            <td class="property-name">ğŸ§² çŸ«é¡½ç£åŠ›</td>
            <td>
              ${inputs[2] !== null ? inputs[2] : '-'}
              ${item.exceedFlags[2] ? '<div class="exceed-warning-text">âš ï¸ è¶…å‡º2å€å‚è€ƒ</div>' : ''}
            </td>
            <td>${prod_coercivity !== null ? prod_coercivity : '-'}</td>
            <td><span class="data-source">${item.prod_coercivity !== null ? 'äº§å“æ•°æ®' : 'é‰´å®šæ•°æ®'}</span></td>
            <td class="match-status ${item.exceedFlags[2] ? 'status-exceed' : (inputs[2] !== null && prod_coercivity !== null && inputs[2] === prod_coercivity ? 'status-match' : 'status-mismatch')}">
              ${item.exceedFlags[2] ? 'âš ï¸ è¶…å‡º' : (inputs[2] !== null && prod_coercivity !== null && inputs[2] === prod_coercivity ? 'âœ… åŒ¹é…' : 'âŒ ä¸åŒ¹é…')}
            </td>
          </tr>
          <tr>
            <td class="property-name">âš¡ é’´ç£</td>
            <td>
              ${inputs[3] !== null ? inputs[3] : '-'}
              ${item.exceedFlags[3] ? '<div class="exceed-warning-text">âš ï¸ è¶…å‡º2å€å‚è€ƒ</div>' : ''}
            </td>
            <td>${prod_cobalt !== null ? prod_cobalt : '-'}</td>
            <td><span class="data-source">${item.prod_cobalt !== null ? 'äº§å“æ•°æ®' : 'é‰´å®šæ•°æ®'}</span></td>
            <td class="match-status ${item.exceedFlags[3] ? 'status-exceed' : (inputs[3] !== null && prod_cobalt !== null && inputs[3] === prod_cobalt ? 'status-match' : 'status-mismatch')}">
              ${item.exceedFlags[3] ? 'âš ï¸ è¶…å‡º' : (inputs[3] !== null && prod_cobalt !== null && inputs[3] === prod_cobalt ? 'âœ… åŒ¹é…' : 'âŒ ä¸åŒ¹é…')}
            </td>
          </tr>
          <tr>
            <td class="property-name">ğŸ›¡ï¸ å¼ºåº¦</td>
            <td>
              ${inputs[4] !== null ? inputs[4] : '-'}
              ${item.exceedFlags[4] ? '<div class="exceed-warning-text">âš ï¸ è¶…å‡º2å€å‚è€ƒ</div>' : ''}
            </td>
            <td>${prod_strength !== null ? prod_strength : '-'}</td>
            <td><span class="data-source">${item.prod_strength !== null ? 'äº§å“æ•°æ®' : 'é‰´å®šæ•°æ®'}</span></td>
            <td class="match-status ${item.exceedFlags[4] ? 'status-exceed' : (inputs[4] !== null && prod_strength !== null && inputs[4] === prod_strength ? 'status-match' : 'status-mismatch')}">
              ${item.exceedFlags[4] ? 'âš ï¸ è¶…å‡º' : (inputs[4] !== null && prod_strength !== null && inputs[4] === prod_strength ? 'âœ… åŒ¹é…' : 'âŒ ä¸åŒ¹é…')}
            </td>
          </tr>
        </table>
      `;

      resultDiv.appendChild(headerDiv);
      resultDiv.appendChild(summaryDiv);
      resultDiv.innerHTML += tableHTML;
      resultsDiv.appendChild(resultDiv);
    }
  </script>
</body>
</html>